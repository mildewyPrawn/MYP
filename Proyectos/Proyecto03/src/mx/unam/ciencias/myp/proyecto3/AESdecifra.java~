//import java.security.SecureRandom;
import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import javax.xml.bind.DatatypeConverter;
import static java.lang.Character.digit;

public class AESdecifra{

	public static byte[] stringToBytes(String clavehash){
    int length = clavehash.length();
    byte[] output = new byte[length / 2];
    
    	for (int i = 0; i < length; i += 2) {
        	output[i / 2] = (byte) ((digit(clavehash.charAt(i), 16) << 4) | digit(clavehash.charAt(i+1), 16));
    	}
    	return output;
	}
    
    public static String decriptar(byte[] key, byte[] iv, String encriptado){
	try{
	    Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
	    SecretKeySpec sks = new SecretKeySpec(key, "AES");
	    cipher.init(Cipher.DECRYPT_MODE, sks, new IvParameterSpec(iv));

	    byte[] dec = cipher.doFinal(DatatypeConverter.parseBase64Binary(encriptado));
	    return new String(dec);
	}catch(Exception e){
	    e.printStackTrace();
	}
	return null;
    }

	public static void main(String[] args){
	String clave = "89a0d30ea1b4cb9aff84758a418e835f06993f9f2446851ef331d30c27173828";
	byte[] iv = "0000000000000000".getBytes();
	byte[] key = stringToBytes(clave); 
	String encriptado = "p355ky/Pe7+ltiqfWBkq29L+0gUINPESKA7e/bA0W1g=";
	System.out.println(decriptar(key, iv, encriptado));
    }
    
}
